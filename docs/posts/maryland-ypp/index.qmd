```{r}
library(tidyverse)
```
```{r}
logs <- read_csv("footballlogs1123.csv")
```
```{r}
winlosslogs <- logs %>% 
  mutate(
    wins = case_when(
      grepl("W", Result) ~ 1, 
      grepl("L", Result) ~ 0))
```
## In this dataframe, we are assigning a value of 1 for every win, and a value of 0 for every loss. 

```{r}
winlosslogs |> 
  group_by(Team, Conference, Season) |> 
  summarise(
    TotalPlays = sum(OffensivePlays), 
    TotalYards = sum(OffensiveYards), 
    DefensivePlays = sum(DefPlays), 
    DefensiveYards = sum(DefYards), 
    TotalWins = sum(wins)) |> 
  mutate(
    OffensiveYPP = TotalYards/TotalPlays, 
    DefensiveYPP = DefensiveYards/DefensivePlays) -> ypp
```
## In this dataframe I am making two columns that are offensive yards per play, as well as defensive yards per play. In addition, we have grouped every team's total wins together from the past 12 seasons.

```{r}
ggplot() + 
  geom_point(
    data=ypp, aes(x=OffensiveYPP, y=DefensiveYPP)
    )
```
## In this dataframe, I am plotting each team based on their offensive yards per play (which is on the x axis), and defensive yards per play (which is on the y axis). Each individual dot represents a team in FBS.

```{r}
ggplot() + 
  geom_point(
    data=ypp, 
    aes(x=OffensiveYPP, y=DefensiveYPP, size=TotalWins)
    )
```
## In this dataframe, I have added an aspect to the yards per play chart, which is wins since 2011. The bigger the dot is, the more wins the team has had in the past 11 1/2 seasons.


```{r}
ggplot() + 
  geom_point(
    data=ypp, 
    aes(x=OffensiveYPP, y=DefensiveYPP, size=TotalWins),
    alpha = .3) + 
  scale_size(range = c(3, 8), name="Wins")
```
## Here I am adding sizescale and range to make the chart a bit easier to read.

```{r}
Maryland <- ypp |> 
  group_by(Team, Conference,Season) %>% 
  filter(Team == "Maryland")
```

## In this code, I am making a dataframe based on Maryland. This has only Maryland's stats from the past 12 years from both the ACC and the Big 10. 

```{r}
ggplot() + 
  geom_point(
    data=ypp, 
    aes(x=OffensiveYPP, y=DefensiveYPP, size=TotalWins), 
    color="grey", 
    alpha=.5) + 
  geom_point(
    data=Maryland, 
    aes(x=OffensiveYPP, y=DefensiveYPP, size=TotalWins), 
    color="red")
```
## In this chart, I made every single team's season in Power 5 from the past 12 years. The dots in red are where Maryland is. 

```{r}
ypp |> 
  ungroup() |> 
  summarise(
    offense = mean(OffensiveYPP), 
    defense = mean(DefensiveYPP)
    )
```

```{r}
ggplot() + 
  geom_point(
    data=ypp, 
    aes(x=OffensiveYPP, y=DefensiveYPP, size=TotalWins), 
    color="grey", 
    alpha=.5) + 
  geom_point(
    data=Maryland, 
    aes(x=OffensiveYPP, y=DefensiveYPP, size=TotalWins), 
    color="red") + 
  geom_vline(xintercept = 5.733647) + 
  geom_hline(yintercept = 5.617537)
```
## Here I am adding averages to be displayed on the chart. 

```{r}
library("ggrepel")
```

```{r}
ggplot() + 
  geom_point(
    data=ypp, 
    aes(x=OffensiveYPP, y=DefensiveYPP, size=TotalWins), 
    color="grey", 
    alpha=.5) + 
  geom_point(
    data=Maryland, 
    aes(x=OffensiveYPP, y=DefensiveYPP, size=TotalWins), 
    color="red") + 
  geom_vline(xintercept = 5.733647) + 
  geom_hline(yintercept = 5.617537) +
  geom_text_repel(
    data=Maryland, 
    aes(x=OffensiveYPP, y=DefensiveYPP, label=Season)
  )
```

## This chart shows each of Maryland's season's since 2011 highlighted in red. The dot next to 2018 on the bottom left does not have a value in the data, but I believe it is last season's data combined with this season's data. 


```{r}
ggplot() + 
  geom_point(
    data=ypp, 
    aes(x=OffensiveYPP, y=DefensiveYPP, size=TotalWins), 
    color="grey", 
    alpha=.5) + 
  geom_point(
    data=Maryland, 
    aes(x=OffensiveYPP, y=DefensiveYPP, size=TotalWins), 
    color="red") + 
  geom_vline(xintercept =  5.733647) + 
  geom_hline(yintercept = 5.617537) + 
  geom_text_repel(
    data=Maryland, 
    aes(x=OffensiveYPP, y=DefensiveYPP, label=Season)
  ) +
  labs(title="Maryland's Yards Per Play vs Wins from 2011-2021", subtitle="Does Maryland win or lose based on the yardage they get and give up?", caption="Source: NCAA | By Ben Reitman")  + theme_minimal() + 
  theme(
    plot.title = element_text(size = 16, face = "bold"),
    axis.title = element_text(size = 8), 
    plot.subtitle = element_text(size=10), 
    panel.grid.minor = element_blank()
    )
```
## Here is the final chart. As we look at every full individual season from 2011-2021 (and last season and this season so far), Maryland is near the average in both offensive yards per play, and defensive yards per play. There are 2 major outlers on this chart. The first one is 2012, a dismal season for Maryland. The Terps were actually 4-2, but then dropped their last six games. Still, it's a bit weird to see a 4-8 team that far out from the middle. The other outliar, 2020, is a hard one to take into account. This was the Covid season and Maryland played just five games due to the pandemic. In those games, the Terps went 2-3 with wins against Minnesota and Penn State, and losses against Northwestern, Indiana, and Rutgers. Maryland's best season on this is 2021, when they went 7-6, and won the Pinstripe Bowl over Syracuse. 






